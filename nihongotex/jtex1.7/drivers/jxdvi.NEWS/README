このファイルは、ＳＯＮＹ　ＮＥＷＳ上で動作するＡＳＣＩＩ版ＪＴｅＸおよび
ＴｅＸ用のｊｘｄｖｉ（ｄｖｉプレビュ−ア−）／ｄｖｉ２ｎｗｐ（ＮＷＰ−５３３
用ｄｖｉドライバ−）を作成、利用するためのＲＥＡＤＭＥファイルです。
-------------------------------------------------------------------------
このディレクトリに含まれるものは次のとおりです。

README.jis : このファイルです。
Makefile
dv.c
font.c
font_load.c
font_db.c
add.c 
table.c
add.h  : jxdvi/dvi2nwp の定数、変数などの宣言。
dvi.h, pxl.h  : （xdviの定数、その他の宣言）
font.h : 漢字フォントに関する定数、変数の宣言

XDisplayName.c : X.V10R4に含まれ、ＮＥＷＳのXlibに含まれないXlib関数

atsuo-copyright.h : 私が行なった修正、付加に関する著作権の宣言
mit-copyright.h : Ｍ．Ｉ．ＴのＸ−ｗｉｎｄｏｗに関する著作権の宣言

mit-copyright.hは、本プログラムがxdviを改造したものであり、さらに
XDisplayName.c を必要とするるために添付してあります。

jxdvi, dvi2nwp でソ−スコ−ドを共有しています。詳しくはMakefileを
ご覧下さい。
---------------------------------------------------------------------------
漢字の利用について
jxdvi/dvi2nwpは漢字フォントとしてＳＯＮＹから販売されている基本フォント
セット、ＮＷＦ−６０４を使用します。以下の説明では基本フォントセットの
各ファイルが/usr/sony/lib/font/devnwp533に読み込まれていることを前提
とします。

７，８，９，１０，１２ポイントのフォントを利用できます。texファイル
中ではそれぞれ、min7 or goth7, min8 or goth8, min9 or goth9,
min10 or goth10, min12 or goth12 という名前になります。
magstep についてはfont_db.cを適当に修正してください。

漢字を利用しない場合は、もちろん基本フォントセットは不要です。
---------------------------------------------------------------------------
ＴｅＸフォントについて
現在のところ、ｐｋフォ−マットのものは使えません。必要なサイズのｐｘｌ
フォントを作成してください。（製法については後述します）ＴｅＸフォント
ディレクトリのデフォ−ルト名は、/usr/lib/tex/fontsです。
---------------------------------------------------------------------------
jxdvi/dvi2nwp の作成およびインスト−ル法（%はshellのプロンプトです）

1. プログラムをmakeします。
    % make all
	これでjxdviおよびdvi2nwpというプログラムが生成されます。
	適当な名前で適当なディレクトリにmvしてください。
2. ス−パユ−ザになって漢字フォントリンクを張ります。
	% make installFont
	これによって、必要な漢字フォントへのシンボリックリンクが
	ＴｅＸフォントディレクトリから張られます。
3. ＡＳＣＩＩから配布されたｊｆｍフォ−マットのtfmファイルを
   ＴｅＸフォントディレクトリにコピ−します。（もちろんリンクでも
   構いません）
	% cp /usr/JTeX/jfm/*.tfm /usr/lib/tex/fonts   
4. ス−パユ−ザになって/etc/printcapファイルを変更します。(dvi2nwp
   を使用するときのみ）
	# vi /etc/printcap
	例えばＮＷＰ５３３のプリンタ名がsjlbpだとします。
	sjlbpの定義に次の一行を加えます。
		df=/usr/local/dvi2nwp\
	以下に例を示します。

    lp|sjlbp|nwp533|nwp-533|NWP533|NWP-533|Sony NEWS NWP-533:\
    	:lp=/dev/lbp:sh:\
    	:sd=/usr/spool/nwp533:\
    	:df=/usr/local/dvi2nwp:\
    	:nf=/usr/sony/lib/lpf_lbpnf:\
    	:tf=/usr/sony/lib/lpf_lbpnf:\
    	:if=/usr/sony/lib/lpf_nwp533:

これて゛作成およびインスト−ルが終了しました。
--------------------------------------------------------------------------
jxdvi/dvi2nwpは以下の値をデファ−ルトとして用います。

ＴｅＸフォントディレクトリ /usr/lib/tex/fonts
各フォントのｄｐｉ数       400
jxdviのshrinkファクタ−    5
dvi2nwpが用いるＮＷＰ−５３３のデバイス名    /dev/lbp

値の変更については、ソ−スコ−ドをご覧下さい。
--------------------------------------------------------------------------
jxdviの使用方法

xdviと全く同じです。ただしドット密度を変えた場合（-pスイッチ）の漢字
の表示はできません。
--------------------------------------------------------------------------
dvi2nwpの使用方法

lprで印刷する方法と、直接dvi2nwpを使用する二つの方法があります。
直接使用する場合はｓｐｏｏｌしないので注意してください。

1. lprを用いる場合
   シェルのプロンプトに対して次のように入力するとdviファイル全ぺ−ジ
   が印刷されます。
       % lpr -d ＜dviファイル名＞

2. 直接使用する場合
   -diスイッチを付けると直接使用モ−ドになります。
       % dvi2nwp -di ＜dviファイル名＞
   -diはdvi2nwpに直接使用であることを伝えるスイッチです。
   直接使用する場合、オプションとして次のスイッチを付けることができます。
        -ds : double side mode （偶数ペ−ジが左にオフセットされて
                                 印刷されます）
        -o  : odd pages only    （dviファイルの奇数ペ−ジのみ印刷されます）
        -e  : even pages only  （同じく偶数ペ−ジのみ印刷されます）
        -bp page : begin printing from 'page'
             （'page'ペ−ジから印刷を開始します）
        -ep page : end printing at 'page'
             （'page'ペ−ジで印刷を終了します）
        -xo dot  : offset 'dot' left
             （紙面上で印刷位置を左に'dot'ドットずらして印刷します）
		-yo dot  : offset 'dot' up
             （紙面上で印刷位置を上に'dot'ドットずらして印刷します）
--------------------------------------------------------------------------
フォントのプレロ−ディングについて

xdviと同様にjxdvi/dvi2nwpもフォントをディマンドロ−ディングします。
通常のＴｅＸでは気になりませんが、漢字を用いるときにはロ−ディングに
かなりの時間がかかるため、特に最初のペ−ジを表示する（印刷する）のに時間が
かかります。

そこでフォントのプレロ−ディングモ−ドを設けました。次のようにすると
jtex.dviに必要なすべてのフォントがプレロ−ドされたjxdvi(dvi2nwp)を
作ることができます。
1. -coreスイッチを付けて全ペ−ジをpreview（印刷）する
	% jxdvi -core jtex.dvi
2. jxdvi(dvi2nwp)終了時にcoreがダンプされる。
	Illegal instruction (core dumped)
3. undumpを使ってcoreを実効可能ファイルに変換する。
	% undump jjj jxdvi core
   必要なフォントすべてがロ−ドされたjxdvi、jjjができる。

jxdviについては十分実用になります。dvi2nwpの場合は、coreが非常に大きく
なるためディスク容量を圧迫してしまい、あまり有効ではありません。
--------------------------------------------------------------------------
ソ−スコ−ドについて

水平タブを４文字間隔に設定して記述されています。
--------------------------------------------------------------------------
今後すべきこと

以下のことをすべきですが、時間の都合で予定が立っていません。
優先度の高い順に示します。

1. フォントファイルとして.pkフォ−マットのものを使えるようにすること。
2. スピ−ドアップ
3. マニュアルの作成
--------------------------------------------------------------------------
著作権について

私が行なった修正、付加については制限を設けません（atsuo-copyright.h
をご覧下さい）
しかしどちらのプログラムもxdviを改造したものなので多少ややこしくなって
います。Ｍ．Ｉ．Ｔもxdviに限ってmit-copyright.hをincludeしていないので
おそらく何もない（ＰＤＳである）のだとは思うのですが．．．

jxdviはXDisplayName.cを用います。これの著作権についてはmit-copyright.h
が適用されます。注意してください。

とりあえずmit-copyright.hも見ておいてください。
-------------------------------------------------------------------------
お願い

バグ情報、要望、改良など何でも結構ですからお知らせください。
まとめて他の方々にも伝えていきたいと考えています。
よろしくお願いします。

                      川口敦生＠産業科学研究所．大阪大学．ｊｕｎｅｔ
                      atsuo@sanken.osaka-u.junet

